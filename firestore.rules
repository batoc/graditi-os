rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // Herramientas/Inventario
    match /tools/{toolId} {
      allow read: if true; // Cualquiera puede ver el inventario
      allow create, update, delete: if request.auth != null; // Solo usuarios autenticados pueden modificar
    }
    
    // Movimientos
    match /movements/{movementId} {
      allow read: if true; // Cualquiera puede ver movimientos
      allow create: if request.auth != null; // Solo usuarios autenticados pueden crear
      allow update, delete: if false; // No se pueden modificar movimientos (registro inmutable)
    }
    
    // Mantenimiento
    match /maintenance/{maintenanceId} {
      allow read: if true;
      allow create, update: if request.auth != null;
      allow delete: if false; // No borrar historial de mantenimiento
    }
    
    // Colaboradores
    match /colaboradores/{colaboradorId} {
      allow read: if true;
      allow create, update, delete: if request.auth != null;
    }
    
    // Obras
    match /obras/{obraId} {
      allow read: if true;
      allow create, update, delete: if request.auth != null;
    }
    
    // Préstamos
    match /prestamos/{prestamoId} {
      allow read: if true;
      allow create, update: if request.auth != null;
      allow delete: if false; // No borrar historial de préstamos
    }
  }
}
